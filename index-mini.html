<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–≤–æ–π –ë—É–¥—É—â–∏–π –ü–∏—Ç–æ–º–µ—Ü</title>
    <style>
        /* –í–°–ï –°–¢–ò–õ–ò –í–ù–£–¢–†–ò –î–õ–Ø –ë–´–°–¢–†–û–ô –ó–ê–ì–†–£–ó–ö–ò */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: -apple-system, BlinkMacSystemFont, sans-serif;
            background: #FFF9FA;
            padding: 20px;
            min-height: 100vh;
        }
        .container {
            max-width: 500px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(255,107,139,0.1);
        }
        h1 { 
            color: #FF6B8B;
            text-align: center;
            margin-bottom: 10px;
            font-size: 24px;
        }
        .subtitle {
            color: #666;
            text-align: center;
            margin-bottom: 30px;
            font-size: 14px;
        }
        .form-group {
            margin-bottom: 20px;
        }
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
        }
        input, select, textarea {
            width: 100%;
            padding: 15px;
            border: 2px solid #E0E0E0;
            border-radius: 12px;
            font-size: 16px;
            background: #F9F9F9;
            font-family: inherit;
        }
        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: #FF6B8B;
            background: white;
        }
        textarea {
            min-height: 100px;
            resize: vertical;
        }
        .btn {
            width: 100%;
            padding: 18px;
            background: linear-gradient(135deg, #FF6B8B 0%, #E55A72 100%);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            margin-top: 20px;
            transition: transform 0.2s;
        }
        .btn:hover {
            transform: translateY(-2px);
        }
        .btn-secondary {
            background: #6BCF7F;
        }
        .hidden {
            display: none;
        }
        .success {
            text-align: center;
            padding: 40px 20px;
        }
        .success h2 {
            color: #6BCF7F;
            margin-bottom: 20px;
        }
        .loading {
            text-align: center;
            padding: 40px;
            color: #666;
        }
        .step {
            display: none;
        }
        .step.active {
            display: block;
            animation: fadeIn 0.3s;
        }
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        .phone-btn {
            background: #4A90E2;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 10px;
            cursor: pointer;
            margin-top: 10px;
            width: 100%;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>–¢–≤–æ–π –ë—É–¥—É—â–∏–π –ü–∏—Ç–æ–º–µ—Ü</h1>
        <p class="subtitle">–ó–∞—è–≤–∫–∞ –Ω–∞ —É—Å—ã–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ –ø—Ä–∏—é—Ç–∞</p>
        
        <!-- –®–∞–≥ 1: –ö–æ–Ω—Ç–∞–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ -->
        <div id="step1" class="step active">
            <div class="form-group">
                <label>–í–∞—à–µ –∏–º—è *</label>
                <input type="text" id="name" placeholder="–ö–∞–∫ –∫ –≤–∞–º –æ–±—Ä–∞—â–∞—Ç—å—Å—è?" required>
            </div>
            
            <div class="form-group">
                <label>–¢–µ–ª–µ—Ñ–æ–Ω *</label>
                <input type="tel" id="phone" placeholder="+7 (900) 000-00-00" required readonly>
                <button type="button" class="phone-btn" onclick="getPhone()">
                    üì± –ü–æ–ª—É—á–∏—Ç—å –∏–∑ Telegram
                </button>
            </div>
            
            <div class="form-group">
                <label>–†–∞–π–æ–Ω –ö–∞–∑–∞–Ω–∏ *</label>
                <select id="district" required>
                    <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Ä–∞–π–æ–Ω</option>
                    <option>–ê–≤–∏–∞—Å—Ç—Ä–æ–∏—Ç–µ–ª—å–Ω—ã–π</option>
                    <option>–í–∞—Ö–∏—Ç–æ–≤—Å–∫–∏–π</option>
                    <option>–ö–∏—Ä–æ–≤—Å–∫–∏–π</option>
                    <option>–ú–æ—Å–∫–æ–≤—Å–∫–∏–π</option>
                    <option>–ù–æ–≤–æ-–°–∞–≤–∏–Ω–æ–≤—Å–∫–∏–π</option>
                    <option>–ü—Ä–∏–≤–æ–ª–∂—Å–∫–∏–π</option>
                    <option>–°–æ–≤–µ—Ç—Å–∫–∏–π</option>
                </select>
            </div>
            
            <button class="btn" onclick="nextStep(2)">–î–∞–ª–µ–µ ‚Üí</button>
        </div>
        
        <!-- –®–∞–≥ 2: –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–∏—Ç–æ–º—Ü–µ -->
        <div id="step2" class="step">
            <div class="form-group">
                <label>–ö–æ–≥–æ —Ö–æ—Ç–∏—Ç–µ –∑–∞–±—Ä–∞—Ç—å? *</label>
                <select id="animalType" required>
                    <option value="">–í—ã–±–µ—Ä–∏—Ç–µ</option>
                    <option value="cat">–ö–æ—à–∫—É/–∫–æ—Ç–∞</option>
                    <option value="dog">–°–æ–±–∞–∫—É</option>
                    <option value="any">–õ—é–±–æ–≥–æ, –∫—Ç–æ –Ω—É–∂–¥–∞–µ—Ç—Å—è</option>
                </select>
            </div>
            
            <div class="form-group">
                <label>–ü—Ä–µ–¥–ø–æ—á—Ç–∏—Ç–µ–ª—å–Ω—ã–π –≤–æ–∑—Ä–∞—Å—Ç</label>
                <select id="age">
                    <option value="any">–õ—é–±–æ–π –≤–æ–∑—Ä–∞—Å—Ç</option>
                    <option value="baby">–©–µ–Ω–æ–∫/–∫–æ—Ç—ë–Ω–æ–∫</option>
                    <option value="young">–ú–æ–ª–æ–¥–æ–π (1-3 –≥–æ–¥–∞)</option>
                    <option value="adult">–í–∑—Ä–æ—Å–ª—ã–π (4-7 –ª–µ—Ç)</option>
                </select>
            </div>
            
            <div class="form-group">
                <label>–û–ø—ã—Ç —Å–æ–¥–µ—Ä–∂–∞–Ω–∏—è –∂–∏–≤–æ—Ç–Ω—ã—Ö *</label>
                <select id="experience" required>
                    <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –æ–ø—ã—Ç</option>
                    <option>–ü–µ—Ä–≤—ã–π –ø–∏—Ç–æ–º–µ—Ü</option>
                    <option>–ë—ã–ª –ø–∏—Ç–æ–º–µ—Ü —Ä–∞–Ω—å—à–µ</option>
                    <option>–°–µ–π—á–∞—Å –µ—Å—Ç—å –∂–∏–≤–æ—Ç–Ω—ã–µ</option>
                </select>
            </div>
            
            <div style="display: flex; gap: 10px;">
                <button class="btn-secondary" onclick="prevStep(1)" style="flex: 1;">
                    ‚Üê –ù–∞–∑–∞–¥
                </button>
                <button class="btn" onclick="nextStep(3)" style="flex: 1;">
                    –î–∞–ª–µ–µ ‚Üí
                </button>
            </div>
        </div>
        
        <!-- –®–∞–≥ 3: –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ -->
        <div id="step3" class="step">
            <div class="form-group">
                <label>–¶–µ–ª—å –æ–±—Ä–∞—â–µ–Ω–∏—è *</label>
                <select id="purpose" required>
                    <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Ü–µ–ª—å</option>
                    <option>–£—Å—ã–Ω–æ–≤–∏—Ç—å –ø–∏—Ç–æ–º—Ü–∞</option>
                    <option>–ü–æ–∑–Ω–∞–∫–æ–º–∏—Ç—å—Å—è —Å–Ω–∞—á–∞–ª–∞</option>
                    <option>–°—Ç–∞—Ç—å –≤–æ–ª–æ–Ω—Ç—ë—Ä–æ–º</option>
                    <option>–ó–∞–¥–∞—Ç—å –≤–æ–ø—Ä–æ—Å</option>
                </select>
            </div>
            
            <div class="form-group">
                <label>–†–∞—Å—Å–∫–∞–∂–∏—Ç–µ –æ —Å–µ–±–µ –∏ —É—Å–ª–æ–≤–∏—è—Ö</label>
                <textarea id="comment" placeholder="–ï—Å—Ç—å –ª–∏ —É –≤–∞—Å –æ–ø—ã—Ç —Å –∂–∏–≤–æ—Ç–Ω—ã–º–∏? –î–µ—Ç–∏? –î–æ–º/–∫–≤–∞—Ä—Ç–∏—Ä–∞?"></textarea>
            </div>
            
            <div class="form-group">
                <label>
                    <input type="checkbox" id="privacy" required style="width: auto; margin-right: 10px;">
                    –Ø —Å–æ–≥–ª–∞—Å–µ–Ω –Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫—É –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
                </label>
            </div>
            
            <div style="display: flex; gap: 10px;">
                <button class="btn-secondary" onclick="prevStep(2)" style="flex: 1;">
                    ‚Üê –ù–∞–∑–∞–¥
                </button>
                <button class="btn" onclick="submitForm()" style="flex: 1;">
                    ‚úÖ –û—Ç–ø—Ä–∞–≤–∏—Ç—å
                </button>
            </div>
        </div>
        
        <!-- –£—Å–ø–µ—Ö -->
        <div id="success" class="success hidden">
            <h2>‚úÖ –ó–∞—è–≤–∫–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞!</h2>
            <p>–°–ø–∞—Å–∏–±–æ –∑–∞ –≤–∞—à–µ –∂–µ–ª–∞–Ω–∏–µ –ø–æ–º–æ—á—å!</p>
            <p>–ö—É—Ä–∞—Ç–æ—Ä –ø—Ä–∏—é—Ç–∞ —Å–≤—è–∂–µ—Ç—Å—è —Å –≤–∞–º–∏ –≤ —Ç–µ—á–µ–Ω–∏–µ 24 —á–∞—Å–æ–≤.</p>
            <button class="btn" onclick="closeApp()" style="margin-top: 30px;">
                –ó–∞–∫—Ä—ã—Ç—å
            </button>
        </div>
        
        <!-- –ó–∞–≥—Ä—É–∑–∫–∞ -->
        <div id="loading" class="loading hidden">
            <p>–û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞—è–≤–∫—É...</p>
        </div>
    </div>

    <!-- Telegram SDK -->
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    
    <script>
        // ===== –ë–ê–ó–û–í–ê–Ø –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø =====
        let tg = window.Telegram.WebApp;
        
        // –°–†–ê–ó–£ —Å–æ–æ–±—â–∞–µ–º Telegram, —á—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≥–æ—Ç–æ–≤–æ
        tg.ready();
        tg.expand();
        
        // ===== –ë–´–°–¢–†–û–ï –ó–ê–ü–û–õ–ù–ï–ù–ò–ï –î–ê–ù–ù–´–• =====
        setTimeout(() => {
            if (tg.initDataUnsafe?.user) {
                const user = tg.initDataUnsafe.user;
                const nameInput = document.getElementById('name');
                if (nameInput && user.first_name) {
                    nameInput.value = user.first_name + ' ' + (user.last_name || '');
                }
            }
            console.log('App loaded in', performance.now(), 'ms');
        }, 50);
        
        // ===== –ù–ê–í–ò–ì–ê–¶–ò–Ø –ü–û –®–ê–ì–ê–ú =====
        function showStep(step) {
            document.querySelectorAll('.step').forEach(s => {
                s.classList.remove('active');
            });
            document.getElementById('step' + step).classList.add('active');
        }
        
        function nextStep(next) {
            // –ü—Ä–æ—Å—Ç–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è
            const current = next - 1;
            const inputs = document.querySelectorAll('#step' + current + ' [required]');
            let valid = true;
            
            inputs.forEach(input => {
                if (!input.value.trim()) {
                    input.style.borderColor = '#FF6B8B';
                    valid = false;
                } else {
                    input.style.borderColor = '#E0E0E0';
                }
            });
            
            if (valid) {
                showStep(next);
                window.scrollTo(0, 0);
            } else {
                alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è');
            }
        }
        
        function prevStep(prev) {
            showStep(prev);
            window.scrollTo(0, 0);
        }
        
        // ===== –ü–û–õ–£–ß–ï–ù–ò–ï –¢–ï–õ–ï–§–û–ù–ê =====
        function getPhone() {
            const phoneInput = document.getElementById('phone');
            const btn = document.querySelector('.phone-btn');
            
            // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏: tg.requestContact()
            // –î–ª—è –¥–µ–º–æ –∏–º–∏—Ç–∏—Ä—É–µ–º
            phoneInput.value = '+7 (900) 123-45-67';
            btn.textContent = '‚úÖ –ö–æ–Ω—Ç–∞–∫—Ç –ø–æ–ª—É—á–µ–Ω';
            btn.disabled = true;
            btn.style.background = '#6BCF7F';
        }
        
        // ===== –û–¢–ü–†–ê–í–ö–ê –§–û–†–ú–´ =====
        function submitForm() {
            const privacy = document.getElementById('privacy');
            if (!privacy.checked) {
                alert('–ù–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–æ–≥–ª–∞—Å–∏–µ –Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫—É –¥–∞–Ω–Ω—ã—Ö');
                return;
            }
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∑–∞–≥—Ä—É–∑–∫—É
            document.getElementById('loading').classList.remove('hidden');
            document.getElementById('step3').classList.remove('active');
            
            // –°–æ–±–∏—Ä–∞–µ–º –¥–∞–Ω–Ω—ã–µ
            const formData = {
                name: document.getElementById('name').value,
                phone: document.getElementById('phone').value,
                district: document.getElementById('district').value,
                animalType: document.getElementById('animalType').value,
                experience: document.getElementById('experience').value,
                purpose: document.getElementById('purpose').value,
                comment: document.getElementById('comment').value,
                timestamp: new Date().toISOString(),
                userId: tg.initDataUnsafe?.user?.id || 'unknown'
            };
            
            console.log('Form data:', formData);
            
            // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –≤ –±–æ—Ç–∞
            setTimeout(() => {
                try {
                    tg.sendData(JSON.stringify({
                        type: 'adoption_form',
                        data: formData
                    }));
                } catch (e) {
                    console.log('Data sent (or simulated)');
                }
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É—Å–ø–µ—Ö
                document.getElementById('loading').classList.add('hidden');
                document.getElementById('success').classList.remove('hidden');
                
                // –ê–≤—Ç–æ–∑–∞–∫—Ä—ã—Ç–∏–µ —á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥
                setTimeout(() => {
                    if (tg.isExpanded) {
                        tg.close();
                    }
                }, 5000);
            }, 1500);
        }
        
        // ===== –ó–ê–ö–†–´–¢–ò–ï =====
        function closeApp() {
            tg.close();
        }
        
        // ===== –≠–ö–°–¢–†–ï–ù–ù–ê–Ø –ü–†–û–í–ï–†–ö–ê =====
        // –ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Ö–æ—Ç—å —á—Ç–æ-—Ç–æ
        setTimeout(() => {
            if (document.querySelectorAll('.step.active').length === 0) {
                showStep(1);
            }
        }, 1000);
    </script>
</body>
</html>
