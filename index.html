<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–≤–æ–π –ë—É–¥—É—â–∏–π –ü–∏—Ç–æ–º–µ—Ü</title>
    
    <!-- Telegram Web App SDK -->
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    
    <style>
        /* –í–°–ï –°–¢–ò–õ–ò –ó–î–ï–°–¨ */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: Arial, sans-serif; padding: 20px; background: #f9f9f9; }
        .container { max-width: 500px; margin: 0 auto; background: white; border-radius: 10px; padding: 20px; }
        h1 { color: #FF6B8B; text-align: center; margin-bottom: 10px; }
        .btn { width: 100%; padding: 15px; margin: 10px 0; border: none; border-radius: 8px; cursor: pointer; }
        .btn-primary { background: #FF6B8B; color: white; font-size: 16px; }
        .btn-secondary { background: #6BCF7F; color: white; }
        .hidden { display: none; }
        input, select, textarea { width: 100%; padding: 12px; margin: 10px 0; border: 1px solid #ddd; border-radius: 8px; }
        .success { text-align: center; padding: 40px 20px; }
        .success h2 { color: #6BCF7F; margin-bottom: 20px; }
    </style>
</head>
<body>
    <div class="container">
        <!-- –ì–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω -->
        <div id="main">
            <h1>üêæ –¢–≤–æ–π –ë—É–¥—É—â–∏–π –ü–∏—Ç–æ–º–µ—Ü</h1>
            <p style="text-align:center;color:#666;margin-bottom:30px;">–°–µ—Ä–≤–∏—Å –¥–ª—è —É—Å—ã–Ω–æ–≤–ª–µ–Ω–∏—è –∂–∏–≤–æ—Ç–Ω—ã—Ö –≤ –ö–∞–∑–∞–Ω–∏</p>
            
            <button class="btn btn-primary" onclick="showForm()">
                ‚ù§Ô∏è –û—Å—Ç–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É –Ω–∞ —É—Å—ã–Ω–æ–≤–ª–µ–Ω–∏–µ
            </button>
            
            <button class="btn btn-secondary" onclick="showInfo()">
                ‚ÑπÔ∏è –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç
            </button>
        </div>
        
        <!-- –§–æ—Ä–º–∞ –∑–∞—è–≤–∫–∏ -->
        <div id="form" class="hidden">
            <h2>üìã –ó–∞—è–≤–∫–∞ –Ω–∞ —É—Å—ã–Ω–æ–≤–ª–µ–Ω–∏–µ</h2>
            
            <input type="text" id="name" placeholder="–í–∞—à–µ –∏–º—è *" required>
            <input type="tel" id="phone" placeholder="–¢–µ–ª–µ—Ñ–æ–Ω *" required>
            
            <select id="purpose" required>
                <option value="">–¶–µ–ª—å –æ–±—Ä–∞—â–µ–Ω–∏—è *</option>
                <option>–£—Å—ã–Ω–æ–≤–∏—Ç—å –ø–∏—Ç–æ–º—Ü–∞</option>
                <option>–ó–∞–ø–∏—Å—å –Ω–∞ –ø—Ä–∏—ë–º –≤ –∫–ª–∏–Ω–∏–∫—É</option>
                <option>–í–æ–ø—Ä–æ—Å —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç—É</option>
            </select>
            
            <select id="animal">
                <option value="">–ö–∞–∫–æ–≥–æ –ø–∏—Ç–æ–º—Ü–∞ –∏—â–µ—Ç–µ? (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)</option>
                <option>–ö–æ—à–∫—É/–∫–æ—Ç–∞</option>
                <option>–°–æ–±–∞–∫—É</option>
                <option>–õ—é–±–æ–≥–æ, –∫—Ç–æ –Ω—É–∂–¥–∞–µ—Ç—Å—è</option>
            </select>
            
            <textarea id="comment" placeholder="–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π (–æ–ø—ã—Ç, —É—Å–ª–æ–≤–∏—è –ø—Ä–æ–∂–∏–≤–∞–Ω–∏—è –∏ —Ç.–¥.)" rows="3"></textarea>
            
            <select id="partner" required>
                <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –ø–∞—Ä—Ç–Ω—ë—Ä–∞ *</option>
                <option>–ü—Ä–∏—é—Ç "–õ–∞–ø–∞ –ø–æ–º–æ—â–∏"</option>
                <option>–í–µ—Ç–∫–ª–∏–Ω–∏–∫–∞ "–î–æ–±—Ä—ã–π –¥–æ–∫—Ç–æ—Ä"</option>
                <option>–ó–æ–æ–º–∞–≥–∞–∑–∏–Ω "–ß–µ—Ç—ã—Ä–µ –ª–∞–ø—ã"</option>
            </select>
            
            <div style="margin: 20px 0;">
                <label style="display:flex;align-items:center;">
                    <input type="checkbox" id="privacy" required style="margin-right:10px;">
                    <span>–°–æ–≥–ª–∞—Å–µ–Ω –Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫—É –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö</span>
                </label>
            </div>
            
            <button class="btn btn-primary" onclick="submitForm()">‚úÖ –û—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É</button>
            <button class="btn" onclick="goBack()">‚Üê –ù–∞–∑–∞–¥</button>
        </div>
        
        <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è -->
        <div id="info" class="hidden">
            <h2>‚ÑπÔ∏è –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç</h2>
            
            <div style="background:#f0f7ff;padding:15px;border-radius:8px;margin:15px 0;">
                <h3>1. –û—Å—Ç–∞–≤–ª—è–µ—Ç–µ –∑–∞—è–≤–∫—É</h3>
                <p>–ó–∞–ø–æ–ª–Ω—è–µ—Ç–µ —Ñ–æ—Ä–º—É —Å –≤–∞—à–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –∏ –ø–æ–∂–µ–ª–∞–Ω–∏—è–º–∏</p>
            </div>
            
            <div style="background:#f0f7ff;padding:15px;border-radius:8px;margin:15px 0;">
                <h3>2. –ü–∞—Ä—Ç–Ω—ë—Ä –ø–æ–ª—É—á–∞–µ—Ç –∑–∞—è–≤–∫—É</h3>
                <p>–ü—Ä–∏—é—Ç –∏–ª–∏ –∫–ª–∏–Ω–∏–∫–∞ –ø–æ–ª—É—á–∞–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –≤ Telegram</p>
            </div>
            
            <div style="background:#f0f7ff;padding:15px;border-radius:8px;margin:15px 0;">
                <h3>3. –°–≤—è–∑—ã–≤–∞—é—Ç—Å—è —Å –≤–∞–º–∏</h3>
                <p>–ü–∞—Ä—Ç–Ω—ë—Ä —Å–≤—è–∑—ã–≤–∞–µ—Ç—Å—è –≤ —Ç–µ—á–µ–Ω–∏–µ 24 —á–∞—Å–æ–≤</p>
            </div>
            
            <div style="background:#f0f7ff;padding:15px;border-radius:8px;margin:15px 0;">
                <h3>4. –ù–∞—Ö–æ–¥–∏—Ç–µ –¥—Ä—É–≥–∞!</h3>
                <p>–ó–Ω–∞–∫–æ–º–∏—Ç–µ—Å—å —Å –ø–∏—Ç–æ–º—Ü–µ–º –∏ –∑–∞–±–∏—Ä–∞–µ—Ç–µ –µ–≥–æ –¥–æ–º–æ–π</p>
            </div>
            
            <button class="btn btn-primary" onclick="showForm()">‚ù§Ô∏è –û—Å—Ç–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É</button>
            <button class="btn" onclick="goBack()">‚Üê –ù–∞–∑–∞–¥</button>
        </div>
        
        <!-- –£—Å–ø–µ—Ö -->
        <div id="success" class="hidden success">
            <h2>‚úÖ –ó–∞—è–≤–∫–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞!</h2>
            <p>–°–ø–∞—Å–∏–±–æ –∑–∞ –≤–∞—à–µ –∂–µ–ª–∞–Ω–∏–µ –ø–æ–º–æ—á—å –∂–∏–≤–æ—Ç–Ω–æ–º—É!</p>
            <p><strong>–ü–∞—Ä—Ç–Ω—ë—Ä –ø–æ–ª—É—á–∏–ª —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –≤ Telegram</strong></p>
            <p style="color:#666;font-size:14px;margin-top:20px;">
                –°—Ç–∞—Ç—É—Å: <span style="background:#FF6B8B;color:white;padding:2px 8px;border-radius:10px;">new</span> (–æ–∂–∏–¥–∞–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏)
            </p>
            <button class="btn btn-primary" onclick="closeApp()" style="margin-top:30px;">
                –ì–æ—Ç–æ–≤–æ
            </button>
        </div>
    </div>

    <script>
        // ===== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø =====
        let tg = window.Telegram.WebApp;
        
        // –ù–µ–º–µ–¥–ª–µ–Ω–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        tg.ready();
        tg.expand();
        
        // –ó–∞–ø–æ–ª–Ω—è–µ–º –∏–º—è –∏–∑ Telegram
        setTimeout(() => {
            if (tg.initDataUnsafe?.user?.first_name) {
                document.getElementById('name').value = tg.initDataUnsafe.user.first_name;
            }
            
            // –†–µ—Ñ–µ—Ä–∞–ª—å–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫
            if (tg.initDataUnsafe?.start_param) {
                console.log('Referral source:', tg.initDataUnsafe.start_param);
            }
            
            // –°–æ–æ–±—â–∞–µ–º, —á—Ç–æ –≤—Å—ë –∑–∞–≥—Ä—É–∂–µ–Ω–æ
            console.log('‚úÖ Mini App loaded successfully');
        }, 50);
        
        // ===== –ù–ê–í–ò–ì–ê–¶–ò–Ø =====
        function showForm() {
            document.getElementById('main').classList.add('hidden');
            document.getElementById('form').classList.remove('hidden');
            document.getElementById('info').classList.add('hidden');
            document.getElementById('success').classList.add('hidden');
        }
        
        function showInfo() {
            document.getElementById('main').classList.add('hidden');
            document.getElementById('form').classList.add('hidden');
            document.getElementById('info').classList.remove('hidden');
            document.getElementById('success').classList.add('hidden');
        }
        
        function goBack() {
            document.getElementById('main').classList.remove('hidden');
            document.getElementById('form').classList.add('hidden');
            document.getElementById('info').classList.add('hidden');
            document.getElementById('success').classList.add('hidden');
        }
        
        // ===== –û–¢–ü–†–ê–í–ö–ê –§–û–†–ú–´ =====
        function submitForm() {
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π
            const name = document.getElementById('name').value;
            const phone = document.getElementById('phone').value;
            const purpose = document.getElementById('purpose').value;
            const partner = document.getElementById('partner').value;
            const privacy = document.getElementById('privacy').checked;
            
            if (!name || !phone || !purpose || !partner || !privacy) {
                alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è –∏ —Å–æ–≥–ª–∞—Å–∏–µ');
                return;
            }
            
            // –°–æ–±–∏—Ä–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ –¢–ó
            const leadData = {
                // 4.1 –§–æ—Ä–º–∞ –∑–∞—è–≤–∫–∏
                name: name,
                phone: phone,
                purpose: purpose,
                animal: document.getElementById('animal').value,
                comment: document.getElementById('comment').value,
                partner: partner,
                
                // 4.3 –°—Ç–∞—Ç—É—Å—ã –ª–∏–¥–∞
                status: 'new', // new / contacted / booked / done / rejected
                
                // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
                userId: tg.initDataUnsafe?.user?.id || 'unknown',
                userFirstName: tg.initDataUnsafe?.user?.first_name || '',
                timestamp: new Date().toISOString(),
                source: tg.initDataUnsafe?.start_param || 'direct',
                
                // –î–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏
                city: '–ö–∞–∑–∞–Ω—å',
                app_version: '1.0'
            };
            
            console.log('Lead data:', leadData);
            
            // 4.2 –î–æ—Å—Ç–∞–≤–∫–∞ –ª–∏–¥–∞ –ø–∞—Ä—Ç–Ω—ë—Ä—É
            try {
                tg.sendData(JSON.stringify({
                    type: 'adoption_lead',
                    data: leadData,
                    // –ü–∞—Ä—Ç–Ω—ë—Ä –ø–æ–ª—É—á–∏—Ç –≤ Telegram
                    partner_name: partner,
                    status: 'new'
                }));
            } catch (e) {
                console.log('Data sent (or simulated)');
            }
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É—Å–ø–µ—Ö
            document.getElementById('form').classList.add('hidden');
            document.getElementById('success').classList.remove('hidden');
            
            // –ê–≤—Ç–æ–∑–∞–∫—Ä—ã—Ç–∏–µ —á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥
            setTimeout(() => {
                if (tg.isExpanded) {
                    tg.close();
                }
            }, 5000);
        }
        
        function closeApp() {
            tg.close();
        }
        
        // –°–æ–æ–±—â–∞–µ–º –æ–± —É—Å–ø–µ—à–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–µ
        setTimeout(() => {
            console.log('üöÄ FuturePetBot Mini App ready');
        }, 100);
    </script>
</body>
</html>
