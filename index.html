<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–≤–æ–π –ë—É–¥—É—â–∏–π –ü–∏—Ç–æ–º–µ—Ü</title>
    
    <!-- Telegram Web App SDK -->
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        /* ===== –û–°–ù–û–í–ù–´–ï –°–¢–ò–õ–ò ===== */
        :root {
            --primary: #4CAF50;
            --primary-dark: #2E7D32;
            --primary-light: #81C784;
            --secondary: #2196F3;
            --secondary-light: #64B5F6;
            --accent: #FF9800;
            --danger: #F44336;
            --light: #F5F5F5;
            --dark: #333333;
            --gray: #757575;
            --border: #E0E0E0;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #f9f9f9 0%, #f0f0f0 100%);
            color: var(--dark);
            min-height: 100vh;
            padding: 10px;
        }
        
        .app-container {
            max-width: 500px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }
        
        /* ===== –®–ê–ü–ö–ê ===== */
        .app-header {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white;
            padding: 20px;
            text-align: center;
        }
        
        .logo {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            margin-bottom: 10px;
        }
        
        .logo-icon {
            width: 50px;
            height: 50px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
        }
        
        .logo-text h1 {
            font-size: 20px;
            font-weight: 700;
        }
        
        .user-mode {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin-top: 10px;
            font-size: 14px;
        }
        
        .mode-switch {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
            transition: all 0.3s;
        }
        
        .mode-switch:hover {
            background: rgba(255, 255, 255, 0.3);
        }
        
        /* ===== –ù–ê–í–ò–ì–ê–¶–ò–Ø ===== */
        .nav-tabs {
            display: flex;
            background: white;
            padding: 10px;
            border-bottom: 1px solid var(--border);
            gap: 5px;
            overflow-x: auto;
        }
        
        .nav-tab {
            flex: none;
            padding: 12px 16px;
            border: none;
            background: var(--light);
            color: var(--gray);
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            border-radius: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
            white-space: nowrap;
            transition: all 0.3s;
        }
        
        .nav-tab.active {
            background: var(--primary);
            color: white;
        }
        
        .nav-tab i {
            font-size: 16px;
        }
        
        /* ===== –û–°–ù–û–í–ù–û–ô –ö–û–ù–¢–ï–ù–¢ ===== */
        .content {
            padding: 20px;
            min-height: 500px;
        }
        
        .page {
            display: none;
        }
        
        .page.active {
            display: block;
            animation: fadeIn 0.3s;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        /* ===== –ö–ê–†–¢–û–ß–ö–ò ===== */
        .card {
            background: white;
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 15px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
            border: 1px solid var(--border);
        }
        
        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .card-title {
            font-size: 18px;
            font-weight: 700;
            color: var(--dark);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        /* ===== –ö–ù–û–ü–ö–ò ===== */
        .btn {
            padding: 16px 20px;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            transition: all 0.3s;
            width: 100%;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.1);
        }
        
        .btn-primary {
            background: var(--primary);
            color: white;
        }
        
        .btn-secondary {
            background: var(--secondary);
            color: white;
        }
        
        .btn-accent {
            background: var(--accent);
            color: white;
        }
        
        .btn-outline {
            background: transparent;
            color: var(--primary);
            border: 2px solid var(--primary);
        }
        
        .btn-small {
            padding: 10px 16px;
            font-size: 14px;
            border-radius: 8px;
        }
        
        /* ===== –§–û–†–ú–´ ===== */
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--dark);
        }
        
        .form-input, .form-select, .form-textarea {
            width: 100%;
            padding: 14px;
            border: 2px solid var(--border);
            border-radius: 12px;
            font-size: 16px;
            background: white;
            font-family: inherit;
        }
        
        .form-input:focus, .form-select:focus, .form-textarea:focus {
            outline: none;
            border-color: var(--primary);
        }
        
        .form-textarea {
            min-height: 100px;
            resize: vertical;
        }
        
        /* ===== –ó–ê–ì–†–£–ó–ö–ê –§–û–¢–û ===== */
        .photo-upload {
            border: 2px dashed var(--border);
            border-radius: 12px;
            padding: 30px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .photo-upload:hover {
            border-color: var(--primary);
            background: rgba(76, 175, 80, 0.05);
        }
        
        .photo-upload i {
            font-size: 48px;
            color: var(--primary);
            margin-bottom: 15px;
        }
        
        .photo-preview {
            display: none;
            margin-top: 20px;
            text-align: center;
        }
        
        .photo-preview img {
            max-width: 100%;
            max-height: 200px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        
        /* ===== –°–ü–ò–°–ö–ò –ü–ò–¢–û–ú–¶–ï–í ===== */
        .pets-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        
        .pet-card {
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s;
            cursor: pointer;
        }
        
        .pet-card:hover {
            transform: translateY(-5px);
        }
        
        .pet-image {
            width: 100%;
            height: 150px;
            background: var(--light);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--gray);
            font-size: 48px;
        }
        
        .pet-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .pet-info {
            padding: 15px;
        }
        
        .pet-name {
            font-weight: 600;
            font-size: 16px;
            margin-bottom: 5px;
        }
        
        .pet-details {
            font-size: 14px;
            color: var(--gray);
        }
        
        /* ===== –£–í–ï–î–û–ú–õ–ï–ù–ò–Ø ===== */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--primary);
            color: white;
            padding: 16px 20px;
            border-radius: 12px;
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
            display: flex;
            align-items: center;
            gap: 12px;
            z-index: 1000;
            animation: slideIn 0.3s;
            max-width: 300px;
        }
        
        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
        
        /* ===== –£–¢–ò–õ–ò–¢–´ ===== */
        .hidden { display: none !important; }
        .text-center { text-align: center; }
        .text-muted { color: var(--gray); font-size: 14px; }
        .mt-20 { margin-top: 20px; }
        .mb-20 { margin-bottom: 20px; }
        
        /* ===== –ë–ê–î–ñ–ò ===== */
        .badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }
        
        .badge-new {
            background: #FFEB3B;
            color: #333;
        }
        
        .badge-shelter {
            background: #2196F3;
            color: white;
        }
        
        .badge-user {
            background: #4CAF50;
            color: white;
        }
        
        /* ===== –°–¢–ê–¢–£–°–´ ===== */
        .status {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }
        
        .status-available {
            background: #4CAF50;
            color: white;
        }
        
        .status-reserved {
            background: #FF9800;
            color: white;
        }
        
        .status-adopted {
            background: #9E9E9E;
            color: white;
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- –®–∞–ø–∫–∞ —Å –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ–º —Ä–µ–∂–∏–º–∞ -->
        <header class="app-header">
            <div class="logo">
                <div class="logo-icon">
                    <i class="fas fa-paw"></i>
                </div>
                <div class="logo-text">
                    <h1>–¢–≤–æ–π –ë—É–¥—É—â–∏–π –ü–∏—Ç–æ–º–µ—Ü</h1>
                </div>
            </div>
            
            <div class="user-mode">
                <span id="currentModeText">–†–µ–∂–∏–º: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</span>
                <button class="mode-switch" onclick="toggleMode()">
                    <i class="fas fa-sync-alt"></i>
                    <span>–°–º–µ–Ω–∏—Ç—å —Ä–µ–∂–∏–º</span>
                </button>
            </div>
        </header>
        
        <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è (–º–µ–Ω—è–µ—Ç—Å—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–µ–∂–∏–º–∞) -->
        <nav class="nav-tabs" id="mainNav">
            <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
        </nav>
        
        <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
        <main class="content">
            <!-- –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è -->
            <div id="user-home" class="page active">
                <div class="card">
                    <h2 class="card-title">
                        <i class="fas fa-home"></i> –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!
                    </h2>
                    <p class="text-muted mb-20">–ù–∞–π–¥–∏ —Å–≤–æ–µ–≥–æ –±—É–¥—É—â–µ–≥–æ –ø–∏—Ç–æ–º—Ü–∞ –∏–ª–∏ –ø–æ–º–æ–≥–∏ –¥—Ä—É–≥–∏–º</p>
                    
                    <div class="pets-grid" id="featuredPets">
                        <!-- –ò–∑–±—Ä–∞–Ω–Ω—ã–µ –ø–∏—Ç–æ–º—Ü—ã -->
                    </div>
                    
                    <button class="btn btn-primary mt-20" onclick="showPage('user-shelters')">
                        <i class="fas fa-search"></i> –ù–∞–π—Ç–∏ –ø–∏—Ç–æ–º—Ü–∞ –≤ –ø—Ä–∏—é—Ç–∞—Ö
                    </button>
                    
                    <button class="btn btn-secondary mt-20" onclick="showPage('user-add-pet')">
                        <i class="fas fa-plus"></i> –í—ã–ª–æ–∂–∏—Ç—å –ø–∏—Ç–æ–º—Ü–∞
                    </button>
                </div>
                
                <div class="card">
                    <h3 class="card-title">
                        <i class="fas fa-history"></i> –ù–µ–¥–∞–≤–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏—è
                    </h3>
                    <div id="userRecentActivity">
                        <!-- –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è -->
                    </div>
                </div>
            </div>
            
            <!-- –ú–æ–∏ –ø–∏—Ç–æ–º—Ü—ã (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å) -->
            <div id="user-pets" class="page">
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">
                            <i class="fas fa-paw"></i> –ú–æ–∏ –ø–∏—Ç–æ–º—Ü—ã
                        </div>
                        <button class="btn btn-primary btn-small" onclick="showPage('user-add-pet')">
                            <i class="fas fa-plus"></i> –î–æ–±–∞–≤–∏—Ç—å
                        </button>
                    </div>
                    
                    <div id="userPetsList" class="pets-grid">
                        <!-- –ü–∏—Ç–æ–º—Ü—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è -->
                    </div>
                </div>
            </div>
            
            <!-- –ü—Ä–∏—é—Ç—ã –∏ –ø–∞—Ä—Ç–Ω—ë—Ä—ã -->
            <div id="user-shelters" class="page">
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">
                            <i class="fas fa-hands-helping"></i> –ü—Ä–∏—é—Ç—ã –∏ –∫–ª–∏–Ω–∏–∫–∏
                        </div>
                    </div>
                    
                    <div id="sheltersList" class="list">
                        <!-- –°–ø–∏—Å–æ–∫ –ø—Ä–∏—é—Ç–æ–≤ -->
                    </div>
                </div>
            </div>
            
            <!-- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–∏—Ç–æ–º—Ü–∞ (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å) -->
            <div id="user-add-pet" class="page">
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">
                            <i class="fas fa-plus-circle"></i> –í—ã–ª–æ–∂–∏—Ç—å –ø–∏—Ç–æ–º—Ü–∞
                        </div>
                        <button class="btn btn-outline btn-small" onclick="showPage('user-home')">
                            <i class="fas fa-arrow-left"></i> –ù–∞–∑–∞–¥
                        </button>
                    </div>
                    
                    <form id="userAddPetForm">
                        <!-- –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–æ—Ç–æ -->
                        <div class="form-group">
                            <label>–§–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è –ø–∏—Ç–æ–º—Ü–∞ *</label>
                            <div class="photo-upload" onclick="document.getElementById('petPhotoInput').click()">
                                <i class="fas fa-camera"></i>
                                <p>–ù–∞–∂–º–∏—Ç–µ —á—Ç–æ–±—ã –∑–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–æ—Ç–æ</p>
                                <p class="text-muted">–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π —Ä–∞–∑–º–µ—Ä: 1000x1000 –ø–∏–∫—Å–µ–ª–µ–π</p>
                                <input type="file" id="petPhotoInput" accept="image/*" class="hidden" 
                                       onchange="handlePhotoUpload(event, 'petPhotoPreview')">
                            </div>
                            <div class="photo-preview" id="petPhotoPreview">
                                <img id="petPhotoPreviewImg" src="" alt="–ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä">
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label>–¢–∏–ø –∂–∏–≤–æ—Ç–Ω–æ–≥–æ *</label>
                            <div style="display: flex; gap: 10px;">
                                <button type="button" class="btn btn-outline btn-small" onclick="selectPetType('cat')" id="btnCat">
                                    <i class="fas fa-cat"></i> –ö–æ—à–∫–∞
                                </button>
                                <button type="button" class="btn btn-outline btn-small" onclick="selectPetType('dog')" id="btnDog">
                                    <i class="fas fa-dog"></i> –°–æ–±–∞–∫–∞
                                </button>
                                <button type="button" class="btn btn-outline btn-small" onclick="selectPetType('other')" id="btnOther">
                                    <i class="fas fa-paw"></i> –î—Ä—É–≥–æ–µ
                                </button>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label>–ò–º—è –ø–∏—Ç–æ–º—Ü–∞ *</label>
                            <input type="text" class="form-input" id="petName" required>
                        </div>
                        
                        <div style="display: flex; gap: 15px;">
                            <div class="form-group" style="flex: 1;">
                                <label>–ü–æ–ª *</label>
                                <select class="form-select" id="petSex" required>
                                    <option value="">–í—ã–±–µ—Ä–∏—Ç–µ</option>
                                    <option value="male">–ú–∞–ª—å—á–∏–∫</option>
                                    <option value="female">–î–µ–≤–æ—á–∫–∞</option>
                                </select>
                            </div>
                            
                            <div class="form-group" style="flex: 1;">
                                <label>–í–æ–∑—Ä–∞—Å—Ç *</label>
                                <input type="text" class="form-input" id="petAge" required placeholder="2 –≥–æ–¥–∞">
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label>–ü–æ—Ä–æ–¥–∞</label>
                            <input type="text" class="form-input" id="petBreed" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ú–µ–π–Ω-–∫—É–Ω">
                        </div>
                        
                        <div class="form-group">
                            <label>–û–ø–∏—Å–∞–Ω–∏–µ *</label>
                            <textarea class="form-textarea" id="petDescription" required 
                                      placeholder="–†–∞—Å—Å–∫–∞–∂–∏—Ç–µ –æ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–µ, –ø—Ä–∏–≤—ã—á–∫–∞—Ö, –∏—Å—Ç–æ—Ä–∏–∏ –ø–∏—Ç–æ–º—Ü–∞..."></textarea>
                        </div>
                        
                        <div class="form-group">
                            <label>–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ *</label>
                            <input type="text" class="form-input" id="petLocation" required 
                                   placeholder="–†–∞–π–æ–Ω –ö–∞–∑–∞–Ω–∏ –∏–ª–∏ –∞–¥—Ä–µ—Å">
                        </div>
                        
                        <div class="form-group">
                            <label>–ö–æ–Ω—Ç–∞–∫—Ç—ã –¥–ª—è —Å–≤—è–∑–∏ *</label>
                            <input type="text" class="form-input" id="petContact" required 
                                   placeholder="–¢–µ–ª–µ—Ñ–æ–Ω –∏–ª–∏ Telegram">
                        </div>
                        
                        <div class="form-group">
                            <label>–°—Ç–∞—Ç—É—Å *</label>
                            <select class="form-select" id="petStatus" required>
                                <option value="available">–ò—â–µ—Ç –¥–æ–º</option>
                                <option value="reserved">–ó–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω</option>
                                <option value="adopted">–£–∂–µ –ø—Ä–∏—Å—Ç—Ä–æ–µ–Ω</option>
                            </select>
                        </div>
                        
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-paper-plane"></i> –û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å –ø–∏—Ç–æ–º—Ü–∞
                        </button>
                    </form>
                </div>
            </div>
            
            <!-- –ì–ª–∞–≤–Ω–∞—è –ø–∞—Ä—Ç–Ω—ë—Ä–∞ -->
            <div id="partner-home" class="page">
                <div class="card">
                    <h2 class="card-title">
                        <i class="fas fa-store"></i> –ü–∞—Ä—Ç–Ω—ë—Ä—Å–∫–∏–π –∫–∞–±–∏–Ω–µ—Ç
                    </h2>
                    
                    <div class="stats-grid" style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin: 20px 0;">
                        <div style="text-align: center; padding: 15px; background: var(--light); border-radius: 12px;">
                            <div style="font-size: 24px; font-weight: bold; color: var(--primary);" id="partnerTotalPets">0</div>
                            <div style="font-size: 12px; color: var(--gray);">–ü–∏—Ç–æ–º—Ü–µ–≤</div>
                        </div>
                        <div style="text-align: center; padding: 15px; background: var(--light); border-radius: 12px;">
                            <div style="font-size: 24px; font-weight: bold; color: var(--secondary);" id="partnerTotalLeads">0</div>
                            <div style="font-size: 12px; color: var(--gray);">–ó–∞—è–≤–æ–∫</div>
                        </div>
                    </div>
                    
                    <button class="btn btn-primary mb-20" onclick="showPage('partner-add-pet')">
                        <i class="fas fa-plus"></i> –î–æ–±–∞–≤–∏—Ç—å –ø–∏—Ç–æ–º—Ü–∞
                    </button>
                    
                    <button class="btn btn-secondary mb-20" onclick="showPage('partner-leads')">
                        <i class="fas fa-inbox"></i> –ó–∞—è–≤–∫–∏ –Ω–∞ —É—Å—ã–Ω–æ–≤–ª–µ–Ω–∏–µ
                    </button>
                    
                    <button class="btn btn-accent" onclick="showPage('partner-pets')">
                        <i class="fas fa-list"></i> –í—Å–µ –ø–∏—Ç–æ–º—Ü—ã –ø—Ä–∏—é—Ç–∞
                    </button>
                </div>
            </div>
            
            <!-- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–∏—Ç–æ–º—Ü–∞ (–ø–∞—Ä—Ç–Ω—ë—Ä) -->
            <div id="partner-add-pet" class="page">
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">
                            <i class="fas fa-plus-circle"></i> –î–æ–±–∞–≤–∏—Ç—å –ø–∏—Ç–æ–º—Ü–∞ –≤ –ø—Ä–∏—é—Ç
                        </div>
                        <button class="btn btn-outline btn-small" onclick="showPage('partner-home')">
                            <i class="fas fa-arrow-left"></i> –ù–∞–∑–∞–¥
                        </button>
                    </div>
                    
                    <form id="partnerAddPetForm">
                        <!-- –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Ñ–æ—Ç–æ -->
                        <div class="form-group">
                            <label>–§–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –ø–∏—Ç–æ–º—Ü–∞ *</label>
                            <div class="photo-upload" onclick="document.getElementById('shelterPhotoInput').click()">
                                <i class="fas fa-images"></i>
                                <p>–ù–∞–∂–º–∏—Ç–µ —á—Ç–æ–±—ã –∑–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–æ—Ç–æ</p>
                                <p class="text-muted">–ú–æ–∂–Ω–æ –∑–∞–≥—Ä—É–∑–∏—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π</p>
                                <input type="file" id="shelterPhotoInput" accept="image/*" class="hidden" multiple
                                       onchange="handleMultiplePhotosUpload(event, 'shelterPhotosPreview')">
                            </div>
                            <div class="photo-preview" id="shelterPhotosPreview">
                                <!-- –ü—Ä–µ–≤—å—é —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π –±—É–¥–µ—Ç –∑–¥–µ—Å—å -->
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label>–¢–∏–ø –∂–∏–≤–æ—Ç–Ω–æ–≥–æ *</label>
                            <select class="form-select" id="shelterPetType" required>
                                <option value="">–í—ã–±–µ—Ä–∏—Ç–µ</option>
                                <option value="cat">–ö–æ—à–∫–∞</option>
                                <option value="dog">–°–æ–±–∞–∫–∞</option>
                                <option value="other">–î—Ä—É–≥–æ–µ –∂–∏–≤–æ—Ç–Ω–æ–µ</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label>–ò–º—è –∏–ª–∏ –∫–ª–∏—á–∫–∞</label>
                            <input type="text" class="form-input" id="shelterPetName" 
                                   placeholder="–ï—Å–ª–∏ –Ω–µ—Ç –∏–º–µ–Ω–∏ - –æ—Å—Ç–∞–≤—å—Ç–µ –ø—É—Å—Ç—ã–º">
                        </div>
                        
                        <div style="display: flex; gap: 15px;">
                            <div class="form-group" style="flex: 1;">
                                <label>–ü–æ–ª *</label>
                                <select class="form-select" id="shelterPetSex" required>
                                    <option value="">–í—ã–±–µ—Ä–∏—Ç–µ</option>
                                    <option value="male">–ú–∞–ª—å—á–∏–∫</option>
                                    <option value="female">–î–µ–≤–æ—á–∫–∞</option>
                                    <option value="unknown">–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ</option>
                                </select>
                            </div>
                            
                            <div class="form-group" style="flex: 1;">
                                <label>–ü—Ä–∏–º–µ—Ä–Ω—ã–π –≤–æ–∑—Ä–∞—Å—Ç</label>
                                <input type="text" class="form-input" id="shelterPetAge" placeholder="1-2 –≥–æ–¥–∞">
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label>–ü–æ—Ä–æ–¥–∞ –∏–ª–∏ –æ–∫—Ä–∞—Å</label>
                            <input type="text" class="form-input" id="shelterPetBreed" 
                                   placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –¥–≤–æ—Ä–Ω—è–≥–∞, —Ä—ã–∂–∏–π">
                        </div>
                        
                        <div style="display: flex; gap: 15px;">
                            <div class="form-group" style="flex: 1;">
                                <label>–í–∞–∫—Ü–∏–Ω–∏—Ä–æ–≤–∞–Ω</label>
                                <select class="form-select" id="shelterPetVaccinated">
                                    <option value="unknown">–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ</option>
                                    <option value="yes">–î–∞</option>
                                    <option value="no">–ù–µ—Ç</option>
                                </select>
                            </div>
                            
                            <div class="form-group" style="flex: 1;">
                                <label>–°—Ç–µ—Ä–∏–ª–∏–∑–æ–≤–∞–Ω</label>
                                <select class="form-select" id="shelterPetSterilized">
                                    <option value="unknown">–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ</option>
                                    <option value="yes">–î–∞</option>
                                    <option value="no">–ù–µ—Ç</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label>–ò—Å—Ç–æ—Ä–∏—è –∏ —Ö–∞—Ä–∞–∫—Ç–µ—Ä *</label>
                            <textarea class="form-textarea" id="shelterPetDescription" required 
                                      placeholder="–ö–∞–∫ –ø–æ–ø–∞–ª –≤ –ø—Ä–∏—é—Ç, –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∞, –∑–¥–æ—Ä–æ–≤—å–µ..."></textarea>
                        </div>
                        
                        <div class="form-group">
                            <label>–û—Å–æ–±—ã–µ –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç–∏</label>
                            <textarea class="form-textarea" id="shelterPetSpecialNeeds" 
                                      placeholder="–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —É—Ö–æ–¥–∞, –¥–∏–µ—Ç–∞, –ª–µ–∫–∞—Ä—Å—Ç–≤–∞..."></textarea>
                        </div>
                        
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-save"></i> –î–æ–±–∞–≤–∏—Ç—å –≤ –±–∞–∑—É –ø—Ä–∏—é—Ç–∞
                        </button>
                    </form>
                </div>
            </div>
            
            <!-- –í—Å–µ –ø–∏—Ç–æ–º—Ü—ã –ø–∞—Ä—Ç–Ω—ë—Ä–∞ -->
            <div id="partner-pets" class="page">
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">
                            <i class="fas fa-list"></i> –ü–∏—Ç–æ–º—Ü—ã –ø—Ä–∏—é—Ç–∞
                        </div>
                        <button class="btn btn-primary btn-small" onclick="showPage('partner-add-pet')">
                            <i class="fas fa-plus"></i> –î–æ–±–∞–≤–∏—Ç—å
                        </button>
                    </div>
                    
                    <div id="shelterPetsList" class="pets-grid">
                        <!-- –ü–∏—Ç–æ–º—Ü—ã –ø—Ä–∏—é—Ç–∞ -->
                    </div>
                </div>
            </div>
            
            <!-- –ó–∞—è–≤–∫–∏ –ø–∞—Ä—Ç–Ω—ë—Ä–∞ -->
            <div id="partner-leads" class="page">
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">
                            <i class="fas fa-inbox"></i> –ó–∞—è–≤–∫–∏ –Ω–∞ —É—Å—ã–Ω–æ–≤–ª–µ–Ω–∏–µ
                        </div>
                    </div>
                    
                    <div id="partnerLeadsList" class="list">
                        <!-- –ó–∞—è–≤–∫–∏ –ø–∞—Ä—Ç–Ω—ë—Ä–∞ -->
                    </div>
                </div>
            </div>
            
            <!-- –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–∏—Ç–æ–º—Ü–µ -->
            <div id="pet-detail" class="page">
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">
                            <i class="fas fa-paw"></i> –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–∏—Ç–æ–º—Ü–µ
                        </div>
                        <button class="btn btn-outline btn-small" onclick="goBack()">
                            <i class="fas fa-arrow-left"></i> –ù–∞–∑–∞–¥
                        </button>
                    </div>
                    
                    <div id="petDetailContent">
                        <!-- –ó–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                    </div>
                </div>
            </div>
            
            <!-- –£—Å–ø–µ—à–Ω–∞—è –ø—É–±–ª–∏–∫–∞—Ü–∏—è -->
            <div id="success" class="page" style="text-align: center; padding: 40px 20px;">
                <div style="width: 80px; height: 80px; background: var(--primary); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 20px; color: white; font-size: 36px;">
                    <i class="fas fa-check"></i>
                </div>
                <h2>–ü–∏—Ç–æ–º–µ—Ü –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω!</h2>
                <p class="text-muted">–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –±—É–¥–µ—Ç –≤–∏–¥–Ω–∞ –¥—Ä—É–≥–∏–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º</p>
                <button class="btn btn-primary mt-20" onclick="showPage('user-home')">
                    <i class="fas fa-home"></i> –ù–∞ –≥–ª–∞–≤–Ω—É—é
                </button>
            </div>
        </main>
    </div>

    <!-- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è -->
    <div id="notification" class="notification hidden">
        <i class="fas fa-check-circle"></i>
        <div id="notificationText"></div>
    </div>

        <script>
        // ===== –ì–õ–û–ë–ê–õ–¨–ù–´–ï –ü–ï–†–ï–ú–ï–ù–ù–´–ï =====
        let tg = window.Telegram.WebApp;
        let currentMode = 'user'; // 'user' –∏–ª–∏ 'partner'
        let currentUser = {};
        let userPets = [];
        let shelterPets = [];
        let allPets = [];
        let userPhotos = [];
        let shelterPhotos = [];
        
        // ===== –°–ò–°–¢–ï–ú–ê –°–û–•–†–ê–ù–ï–ù–ò–Ø –î–ê–ù–ù–´–• =====
        
        // –ü–æ–ª—É—á–∏—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—ã–π ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        function getUserId() {
            if (tg.initDataUnsafe?.user?.id) {
                return tg.initDataUnsafe.user.id;
            }
            return 'guest_' + Date.now();
        }
        
        // –ü–æ–ª—É—á–∏—Ç—å –∫–ª—é—á –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        function getUserStorageKey(key) {
            return `futurepet_${getUserId()}_${key}`;
        }
        
        // –ü–æ–ª—É—á–∏—Ç—å –∫–ª—é—á –¥–ª—è –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö (–¥–æ—Å—Ç—É–ø–Ω—ã—Ö –≤—Å–µ–º)
        function getGlobalStorageKey(key) {
            return `futurepet_global_${key}`;
        }
        
        // –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        function saveUserData(key, data) {
            const storageKey = getUserStorageKey(key);
            try {
                localStorage.setItem(storageKey, JSON.stringify(data));
                console.log(`–°–æ—Ö—Ä–∞–Ω–µ–Ω–æ: ${storageKey}`, data);
            } catch (e) {
                console.error('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è:', e);
            }
        }
        
        // –ó–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        function loadUserData(key, defaultValue = null) {
            const storageKey = getUserStorageKey(key);
            try {
                const data = localStorage.getItem(storageKey);
                return data ? JSON.parse(data) : defaultValue;
            } catch (e) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏:', e);
                return defaultValue;
            }
        }
        
        // –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
        function saveGlobalData(key, data) {
            const storageKey = getGlobalStorageKey(key);
            try {
                localStorage.setItem(storageKey, JSON.stringify(data));
            } catch (e) {
                console.error('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö:', e);
            }
        }
        
        // –ó–∞–≥—Ä—É–∑–∏—Ç—å –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
        function loadGlobalData(key, defaultValue = null) {
            const storageKey = getGlobalStorageKey(key);
            try {
                const data = localStorage.getItem(storageKey);
                return data ? JSON.parse(data) : defaultValue;
            } catch (e) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö:', e);
                return defaultValue;
            }
        }
        
        // –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ
        function saveAllData() {
            saveUserData('mode', currentMode);
            saveUserData('user_pets', userPets);
            saveGlobalData('all_pets', allPets);
            saveGlobalData('shelter_pets', shelterPets);
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            if (tg.initDataUnsafe?.user) {
                const user = tg.initDataUnsafe.user;
                saveUserData('profile', {
                    id: user.id,
                    name: `${user.first_name} ${user.last_name || ''}`.trim(),
                    username: user.username,
                    lastLogin: new Date().toISOString()
                });
            }
            
            console.log('‚úÖ –í—Å–µ –¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã');
        }
        
        // –ó–∞–≥—Ä—É–∑–∏—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ
        function loadAllData() {
            currentMode = loadUserData('mode', 'user');
            userPets = loadUserData('user_pets', []);
            shelterPets = loadGlobalData('shelter_pets', []);
            allPets = loadGlobalData('all_pets', []);
            
            // –ï—Å–ª–∏ allPets –ø—É—Å—Ç–æ–π, –æ–±—ä–µ–¥–∏–Ω—è–µ–º userPets –∏ shelterPets
            if (allPets.length === 0 && (userPets.length > 0 || shelterPets.length > 0)) {
                allPets = [...userPets, ...shelterPets];
                saveGlobalData('all_pets', allPets);
            }
            
            console.log('üìÇ –î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã:', {
                userPets: userPets.length,
                shelterPets: shelterPets.length,
                allPets: allPets.length,
                mode: currentMode
            });
        }
        
        // –û—á–∏—Å—Ç–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        function clearUserData() {
            const userId = getUserId();
            const prefix = `futurepet_${userId}_`;
            
            for (let i = 0; i < localStorage.length; i++) {
                const key = localStorage.key(i);
                if (key.startsWith(prefix)) {
                    localStorage.removeItem(key);
                }
            }
            
            userPets = [];
            currentMode = 'user';
            showNotification('–î–∞–Ω–Ω—ã–µ –æ—á–∏—â–µ–Ω—ã', 'success');
            location.reload();
        }
        
        // –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å —Å–µ—Ä–≤–µ—Ä–æ–º –±–æ—Ç–∞
        function syncWithBot() {
            const dataToSend = {
                userId: getUserId(),
                userPets: userPets,
                mode: currentMode,
                timestamp: new Date().toISOString()
            };
            
            try {
                tg.sendData(JSON.stringify({
                    type: 'sync_data',
                    data: dataToSend
                }));
                console.log('üîÑ –î–∞–Ω–Ω—ã–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω—ã —Å –±–æ—Ç–æ–º');
            } catch (e) {
                console.log('–ë–æ—Ç —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è (–¥–µ–º–æ —Ä–µ–∂–∏–º)');
            }
        }
        
        // ===== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø =====
        document.addEventListener('DOMContentLoaded', function() {
            // 1. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram
            tg.ready();
            tg.expand();
            
            // 2. –°–æ—Ö—Ä–∞–Ω—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –ø–µ—Ä–µ–¥ –∑–∞–∫—Ä—ã—Ç–∏–µ–º
            tg.onEvent('viewportChanged', function() {
                if (!tg.isExpanded) {
                    saveAllData();
                }
            });
            
            // 3. –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            loadUserProfile();
            
            // 4. –ó–∞–≥—Ä—É–∑–∫–∞ –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö
            loadAllData();
            
            // 5. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
            updateNavigation();
            
            // 6. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ñ–æ—Ä–º
            initForms();
            
            // 7. –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–∞—á–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
            loadInitialData();
            
            // 8. –ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
            setInterval(() => {
                saveAllData();
            }, 30000);
            
            showNotification(`–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å! –î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã`, 'info');
        });
        
        // ===== –£–ü–†–ê–í–õ–ï–ù–ò–ï –†–ï–ñ–ò–ú–ê–ú–ò =====
        function toggleMode() {
            if (currentMode === 'user') {
                currentMode = 'partner';
                document.getElementById('currentModeText').textContent = '–†–µ–∂–∏–º: –ü–∞—Ä—Ç–Ω—ë—Ä';
                saveUserData('mode', 'partner');
                showNotification('–ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–æ –≤ —Ä–µ–∂–∏–º –ø–∞—Ä—Ç–Ω—ë—Ä–∞', 'info');
            } else {
                currentMode = 'user';
                document.getElementById('currentModeText').textContent = '–†–µ–∂–∏–º: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å';
                saveUserData('mode', 'user');
                showNotification('–ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–æ –≤ —Ä–µ–∂–∏–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è', 'info');
            }
            
            updateNavigation();
            showPage(currentMode + '-home');
        }
        
        function updateNavigation() {
            const nav = document.getElementById('mainNav');
            
            if (currentMode === 'user') {
                nav.innerHTML = `
                    <button class="nav-tab active" data-page="user-home">
                        <i class="fas fa-home"></i> –ì–ª–∞–≤–Ω–∞—è
                    </button>
                    <button class="nav-tab" data-page="user-pets">
                        <i class="fas fa-paw"></i> –ú–æ–∏ –ø–∏—Ç–æ–º—Ü—ã
                    </button>
                    <button class="nav-tab" data-page="user-shelters">
                        <i class="fas fa-hands-helping"></i> –ü—Ä–∏—é—Ç—ã
                    </button>
                    <button class="nav-tab" data-page="user-add-pet">
                        <i class="fas fa-plus"></i> –í—ã–ª–æ–∂–∏—Ç—å –ø–∏—Ç–æ–º—Ü–∞
                    </button>
                    <button class="nav-tab" data-page="user-settings">
                        <i class="fas fa-cog"></i> –ù–∞—Å—Ç—Ä–æ–π–∫–∏
                    </button>
                `;
            } else {
                nav.innerHTML = `
                    <button class="nav-tab active" data-page="partner-home">
                        <i class="fas fa-store"></i> –ö–∞–±–∏–Ω–µ—Ç
                    </button>
                    <button class="nav-tab" data-page="partner-pets">
                        <i class="fas fa-list"></i> –ü–∏—Ç–æ–º—Ü—ã
                    </button>
                    <button class="nav-tab" data-page="partner-add-pet">
                        <i class="fas fa-plus"></i> –î–æ–±–∞–≤–∏—Ç—å
                    </button>
                    <button class="nav-tab" data-page="partner-leads">
                        <i class="fas fa-inbox"></i> –ó–∞—è–≤–∫–∏
                    </button>
                    <button class="nav-tab" data-page="partner-settings">
                        <i class="fas fa-cog"></i> –ù–∞—Å—Ç—Ä–æ–π–∫–∏
                    </button>
                `;
            }
            
            // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –Ω–æ–≤—ã—Ö –∫–Ω–æ–ø–æ–∫
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    const pageId = this.dataset.page;
                    showPage(pageId);
                });
            });
        }
        
        // ===== –ù–ê–í–ò–ì–ê–¶–ò–Ø =====
        function showPage(pageId) {
            // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            
            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –∞–∫—Ç–∏–≤–Ω—ã–µ –≤–∫–ª–∞–¥–∫–∏
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –Ω—É–∂–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É
            const page = document.getElementById(pageId);
            if (page) {
                page.classList.add('active');
            }
            
            // –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º –≤–∫–ª–∞–¥–∫—É
            const tab = document.querySelector(`[data-page="${pageId}"]`);
            if (tab) {
                tab.classList.add('active');
            }
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã
            switch(pageId) {
                case 'user-home':
                    loadUserHome();
                    break;
                case 'user-pets':
                    loadUserPets();
                    break;
                case 'user-settings':
                    loadUserSettings();
                    break;
                case 'partner-home':
                    loadPartnerHome();
                    break;
                case 'partner-pets':
                    loadShelterPets();
                    break;
                case 'partner-leads':
                    loadPartnerLeads();
                    break;
                case 'partner-settings':
                    loadPartnerSettings();
                    break;
            }
            
            window.scrollTo(0, 0);
        }
        
        function goBack() {
            if (currentMode === 'user') {
                showPage('user-home');
            } else {
                showPage('partner-home');
            }
        }
        
        // ===== –ó–ê–ì–†–£–ó–ö–ê –î–ê–ù–ù–´–• =====
        function loadUserProfile() {
            if (tg.initDataUnsafe?.user) {
                const user = tg.initDataUnsafe.user;
                currentUser = {
                    id: user.id,
                    name: `${user.first_name} ${user.last_name || ''}`.trim(),
                    username: user.username
                };
                
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –ø—Ä–æ—Ñ–∏–ª—å
                saveUserData('profile', currentUser);
            }
        }
        
        function loadInitialData() {
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ localStorage
            loadAllData();
            
            // –ï—Å–ª–∏ –Ω–µ—Ç —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö - —Å–æ–∑–¥–∞—ë–º –¥–µ–º–æ
            if (allPets.length === 0) {
                createDemoPets();
            }
            
            loadUserHome();
        }
        
        function createDemoPets() {
            // –î–µ–º–æ-–ø–∏—Ç–æ–º—Ü—ã –¥–ª—è –ø—Ä–∏—é—Ç–∞
            const demoPets = [
                {
                    id: 'demo_1',
                    ownerId: 'shelter_1',
                    ownerType: 'shelter',
                    type: 'cat',
                    name: '–ë–∞—Ä—Å–∏–∫',
                    sex: 'male',
                    age: '2 –≥–æ–¥–∞',
                    breed: '–ú–µ–π–Ω-–∫—É–Ω',
                    description: '–î–æ–±—Ä—ã–π –∏ –ª–∞—Å–∫–æ–≤—ã–π –∫–æ—Ç, –∏—â–µ—Ç –∑–∞–±–æ—Ç–ª–∏–≤—É—é —Å–µ–º—å—é',
                    location: '–ü—Ä–∏—é—Ç "–õ–∞–ø–∞ –ø–æ–º–æ—â–∏", –ö–∏—Ä–æ–≤—Å–∫–∏–π —Ä–∞–π–æ–Ω',
                    contact: '+7 (843) 222-33-44',
                    status: 'available',
                    photos: [],
                    vaccinated: 'yes',
                    sterilized: 'yes',
                    createdAt: '2024-01-10T10:00:00Z'
                },
                {
                    id: 'demo_2',
                    ownerId: 'shelter_1',
                    ownerType: 'shelter',
                    type: 'dog',
                    name: '–®–∞—Ä–∏–∫',
                    sex: 'male',
                    age: '4 –≥–æ–¥–∞',
                    breed: '–õ–∞–±—Ä–∞–¥–æ—Ä',
                    description: '–ê–∫—Ç–∏–≤–Ω—ã–π –∏ –¥—Ä—É–∂–µ–ª—é–±–Ω—ã–π –ø—ë—Å, –ª—é–±–∏—Ç –¥–µ—Ç–µ–π',
                    location: '–ü—Ä–∏—é—Ç "–õ–∞–ø–∞ –ø–æ–º–æ—â–∏", –ö–∏—Ä–æ–≤—Å–∫–∏–π —Ä–∞–π–æ–Ω',
                    contact: '+7 (843) 222-33-44',
                    status: 'available',
                    photos: [],
                    vaccinated: 'yes',
                    sterilized: 'yes',
                    createdAt: '2024-01-05T14:00:00Z'
                }
            ];
            
            shelterPets = demoPets;
            allPets = [...demoPets];
            
            saveGlobalData('shelter_pets', shelterPets);
            saveGlobalData('all_pets', allPets);
        }
        
        // ===== –ì–õ–ê–í–ù–ê–Ø –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–Ø =====
        function loadUserHome() {
            // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –∏–∑–±—Ä–∞–Ω–Ω—ã—Ö –ø–∏—Ç–æ–º—Ü–µ–≤
            const container = document.getElementById('featuredPets');
            container.innerHTML = '';
            
            // –ë–µ—Ä—ë–º –ø–æ—Å–ª–µ–¥–Ω–∏—Ö 4 –ø–∏—Ç–æ–º—Ü–∞
            const featured = allPets.slice(0, 4);
            
            featured.forEach(pet => {
                const petCard = createPetCard(pet);
                container.appendChild(petCard);
            });
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å
            loadUserActivity();
        }
        
        function createPetCard(pet) {
            const card = document.createElement('div');
            card.className = 'pet-card';
            card.onclick = () => showPetDetail(pet.id);
            
            let typeIcon = 'üêæ';
            if (pet.type === 'cat') typeIcon = 'üê±';
            if (pet.type === 'dog') typeIcon = 'üê∂';
            
            card.innerHTML = `
                <div class="pet-image">
                    ${pet.photos && pet.photos.length > 0 ? 
                        `<img src="${pet.photos[0]}" alt="${pet.name}">` : 
                        `<i class="fas fa-${pet.type === 'cat' ? 'cat' : 'dog'}"></i>`
                    }
                </div>
                <div class="pet-info">
                    <div class="pet-name">${pet.name || '–ë–µ–∑ –∏–º–µ–Ω–∏'}</div>
                    <div class="pet-details">
                        ${typeIcon} ${pet.age || ''}
                    </div>
                    <div style="margin-top: 8px;">
                        <span class="badge ${pet.ownerType === 'shelter' ? 'badge-shelter' : 'badge-user'}">
                            ${pet.ownerType === 'shelter' ? '–ü—Ä–∏—é—Ç' : '–ß–∞—Å—Ç–Ω–æ–µ –ª–∏—Ü–æ'}
                        </span>
                        <span class="status status-${pet.status}" style="float: right;">
                            ${pet.status === 'available' ? '–ò—â–µ—Ç –¥–æ–º' : 
                              pet.status === 'reserved' ? '–ó–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω' : '–ü—Ä–∏—Å—Ç—Ä–æ–µ–Ω'}
                        </span>
                    </div>
                </div>
            `;
            
            return card;
        }
        
        function loadUserActivity() {
            const container = document.getElementById('userRecentActivity');
            const userPetCount = userPets.filter(pet => pet.ownerId === currentUser.id).length;
            
            container.innerHTML = `
                <div class="list-item">
                    <i class="fas fa-paw" style="color: var(--primary);"></i>
                    <span>–í–∞—à–∏—Ö –ø–∏—Ç–æ–º—Ü–µ–≤: ${userPetCount}</span>
                </div>
                <div class="list-item">
                    <i class="fas fa-heart" style="color: var(--danger);"></i>
                    <span>–ü–∏—Ç–æ–º—Ü–µ–≤ –≤ –ø—Ä–∏—é—Ç–∞—Ö: ${shelterPets.length}</span>
                </div>
            `;
        }
        
        // ===== –ú–û–ò –ü–ò–¢–û–ú–¶–´ (–ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–¨) =====
        function loadUserPets() {
            const container = document.getElementById('userPetsList');
            container.innerHTML = '';
            
            const userPetsList = userPets.filter(pet => pet.ownerId === currentUser.id);
            
            if (userPetsList.length === 0) {
                container.innerHTML = `
                    <div class="text-center" style="grid-column: 1 / -1; padding: 40px 20px;">
                        <i class="fas fa-paw" style="font-size: 48px; color: var(--primary-light); margin-bottom: 20px;"></i>
                        <h3 style="color: var(--dark); margin-bottom: 10px;">–ù–µ—Ç –ø–∏—Ç–æ–º—Ü–µ–≤</h3>
                        <p class="text-muted">–í—ã –µ—â–µ –Ω–µ –≤—ã–∫–ª–∞–¥—ã–≤–∞–ª–∏ –ø–∏—Ç–æ–º—Ü–µ–≤</p>
                        <button class="btn btn-primary mt-20" onclick="showPage('user-add-pet')">
                            <i class="fas fa-plus"></i> –í—ã–ª–æ–∂–∏—Ç—å –ø–µ—Ä–≤–æ–≥–æ –ø–∏—Ç–æ–º—Ü–∞
                        </button>
                    </div>
                `;
                return;
            }
            
            userPetsList.forEach(pet => {
                const petCard = createPetCard(pet);
                container.appendChild(petCard);
            });
        }
        
        // ===== –ù–ê–°–¢–†–û–ô–ö–ò –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–Ø =====
        function loadUserSettings() {
            const settingsPage = document.getElementById('user-settings');
            if (!settingsPage) {
                // –°–æ–∑–¥–∞—ë–º —Å—Ç—Ä–∞–Ω–∏—Ü—É –Ω–∞—Å—Ç—Ä–æ–µ–∫
                const html = `
                    <div class="card">
                        <div class="card-header">
                            <div class="card-title">
                                <i class="fas fa-cog"></i> –ù–∞—Å—Ç—Ä–æ–π–∫–∏
                            </div>
                        </div>
                        
                        <div class="user-info" style="text-align: center; margin-bottom: 30px;">
                            <div class="user-avatar" style="width: 80px; height: 80px; background: var(--primary); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 15px; color: white; font-size: 36px;">
                                <i class="fas fa-user"></i>
                            </div>
                            <h3>${currentUser.name || '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å'}</h3>
                            <p class="text-muted">ID: ${currentUser.id}</p>
                        </div>
                        
                        <button class="btn btn-outline mb-20" onclick="exportUserData()">
                            <i class="fas fa-download"></i> –≠–∫—Å–ø–æ—Ä—Ç –º–æ–∏—Ö –¥–∞–Ω–Ω—ã—Ö
                        </button>
                        
                        <button class="btn btn-outline mb-20" onclick="clearUserData()">
                            <i class="fas fa-trash"></i> –û—á–∏—Å—Ç–∏—Ç—å –º–æ–∏ –¥–∞–Ω–Ω—ã–µ
                        </button>
                        
                        <div style="margin-top: 30px; padding: 20px; background: var(--light); border-radius: 12px;">
                            <h4 style="color: var(--dark); margin-bottom: 10px;">–û –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏</h4>
                            <p style="font-size: 14px; color: var(--gray);">
                                "–¢–≤–æ–π –ë—É–¥—É—â–∏–π –ü–∏—Ç–æ–º–µ—Ü" - —Å–µ—Ä–≤–∏—Å –¥–ª—è –ø–æ–º–æ—â–∏ –∂–∏–≤–æ—Ç–Ω—ã–º –≤ –ö–∞–∑–∞–Ω–∏.<br>
                                –í–µ—Ä—Å–∏—è 1.0.0<br>
                                –í—Å–µ –¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ –≤ –≤–∞—à–µ–º –±—Ä–∞—É–∑–µ—Ä–µ.
                            </p>
                        </div>
                    </div>
                `;
                
                const div = document.createElement('div');
                div.id = 'user-settings';
                div.className = 'page';
                div.innerHTML = html;
                document.querySelector('.content').appendChild(div);
            }
            
            showPage('user-settings');
        }
        
        // ===== –î–û–ë–ê–í–õ–ï–ù–ò–ï –ü–ò–¢–û–ú–¶–ê =====
        function initForms() {
            // –§–æ—Ä–º–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            const userForm = document.getElementById('userAddPetForm');
            if (userForm) {
                userForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    
                    const newPet = {
                        id: 'pet_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9),
                        ownerId: currentUser.id,
                        ownerType: 'user',
                        type: window.selectedPetType || 'other',
                        name: document.getElementById('petName').value,
                        sex: document.getElementById('petSex').value,
                        age: document.getElementById('petAge').value,
                        breed: document.getElementById('petBreed').value,
                        description: document.getElementById('petDescription').value,
                        location: document.getElementById('petLocation').value,
                        contact: document.getElementById('petContact').value,
                        status: document.getElementById('petStatus').value,
                        photos: userPhotos,
                        createdAt: new Date().toISOString(),
                        updatedAt: new Date().toISOString()
                    };
                    
                    // –°–æ—Ö—Ä–∞–Ω—è–µ–º
                    userPets.push(newPet);
                    allPets.unshift(newPet);
                    
                    // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ localStorage
                    saveUserData('user_pets', userPets);
                    saveGlobalData('all_pets', allPets);
                    
                    // –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ–º —Å –±–æ—Ç–æ–º
                    syncWithBot();
                    
                    // –û—á–∏—â–∞–µ–º —Ñ–æ—Ä–º—É
                    this.reset();
                    userPhotos = [];
                    document.getElementById('petPhotoPreview').style.display = 'none';
                    
                    // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫–∏ —Ç–∏–ø–∞
                    ['btnCat', 'btnDog', 'btnOther'].forEach(id => {
                        const btn = document.getElementById(id);
                        if (btn) {
                            btn.style.background = 'transparent';
                            btn.style.color = 'var(--primary)';
                        }
                    });
                    window.selectedPetType = null;
                    
                    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É—Å–ø–µ—Ö
                    showPage('success');
                    showNotification('–ü–∏—Ç–æ–º–µ—Ü —É—Å–ø–µ—à–Ω–æ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω!', 'success');
                });
            }
            
            // –§–æ—Ä–º–∞ –ø–∞—Ä—Ç–Ω—ë—Ä–∞
            const partnerForm = document.getElementById('partnerAddPetForm');
            if (partnerForm) {
                partnerForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    
                    const newPet = {
                        id: 'shelter_pet_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9),
                        ownerId: currentUser.id,
                        ownerType: 'shelter',
                        type: document.getElementById('shelterPetType').value,
                        name: document.getElementById('shelterPetName').value,
                        sex: document.getElementById('shelterPetSex').value,
                        age: document.getElementById('shelterPetAge').value,
                        breed: document.getElementById('shelterPetBreed').value,
                        vaccinated: document.getElementById('shelterPetVaccinated').value,
                        sterilized: document.getElementById('shelterPetSterilized').value,
                        description: document.getElementById('shelterPetDescription').value,
                        specialNeeds: document.getElementById('shelterPetSpecialNeeds').value,
                        status: 'available',
                        photos: shelterPhotos,
                        location: '–ü—Ä–∏—é—Ç',
                        contact: '–ß–µ—Ä–µ–∑ –ø—Ä–∏—é—Ç',
                        createdAt: new Date().toISOString(),
                        updatedAt: new Date().toISOString()
                    };
                    
                    // –°–æ—Ö—Ä–∞–Ω—è–µ–º
                    shelterPets.push(newPet);
                    allPets.unshift(newPet);
                    
                    // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ localStorage
                    saveGlobalData('shelter_pets', shelterPets);
                    saveGlobalData('all_pets', allPets);
                    
                    // –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ–º —Å –±–æ—Ç–æ–º
                    syncWithBot();
                    
                    // –û—á–∏—â–∞–µ–º —Ñ–æ—Ä–º—É
                    this.reset();
                    shelterPhotos = [];
                    const preview = document.getElementById('shelterPhotosPreview');
                    if (preview) {
                        preview.style.display = 'none';
                        preview.innerHTML = '';
                    }
                    
                    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É—Å–ø–µ—Ö
                    showPage('partner-home');
                    showNotification('–ü–∏—Ç–æ–º–µ—Ü –¥–æ–±–∞–≤–ª–µ–Ω –≤ –±–∞–∑—É –ø—Ä–∏—é—Ç–∞!', 'success');
                });
            }
        }
        
        // ===== –ó–ê–ì–†–£–ó–ö–ê –§–û–¢–û–ì–†–ê–§–ò–ô =====
        function handlePhotoUpload(event, previewId) {
            const file = event.target.files[0];
            if (!file) return;
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ (–º–∞–∫—Å–∏–º—É–º 5MB)
            if (file.size > 5 * 1024 * 1024) {
                showNotification('–§–∞–π–ª —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–π (–º–∞–∫—Å. 5MB)', 'error');
                return;
            }
            
            const reader = new FileReader();
            reader.onload = function(e) {
                const preview = document.getElementById(previewId);
                const img = document.getElementById(previewId + 'Img');
                
                if (img) {
                    img.src = e.target.result;
                    preview.style.display = 'block';
                    
                    // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ñ–æ—Ç–æ
                    userPhotos = [e.target.result];
                    
                    // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ñ–æ—Ç–æ –≤ localStorage (–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ)
                    saveUserData('last_photo', e.target.result);
                }
            };
            reader.onerror = function() {
                showNotification('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–æ—Ç–æ', 'error');
            };
            reader.readAsDataURL(file);
        }
        
        function handleMultiplePhotosUpload(event, previewId) {
            const files = event.target.files;
            if (!files.length) return;
            
            const preview = document.getElementById(previewId);
            preview.innerHTML = '';
            shelterPhotos = [];
            
            // –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ñ–∞–π–ª–æ–≤
            const maxFiles = Math.min(files.length, 5);
            
            for (let i = 0; i < maxFiles; i++) {
                const file = files[i];
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞
                if (file.size > 5 * 1024 * 1024) {
                    showNotification(`–§–æ—Ç–æ ${i+1} —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–µ (–º–∞–∫—Å. 5MB)`, 'error');
                    continue;
                }
                
                const reader = new FileReader();
                reader.onload = (function(file, index) {
                    return function(e) {
                        shelterPhotos.push(e.target.result);
                        
                        const imgContainer = document.createElement('div');
                        imgContainer.style.cssText = `
                            display: inline-block;
                            margin: 5px;
                            width: 80px;
                            height: 80px;
                            border-radius: 8px;
                            overflow: hidden;
                            position: relative;
                        `;
                        
                        const img = document.createElement('img');
                        img.src = e.target.result;
                        img.style.cssText = 'width: 100%; height: 100%; object-fit: cover;';
                        
                        // –ù–æ–º–µ—Ä —Ñ–æ—Ç–æ
                        const number = document.createElement('div');
                        number.style.cssText = `
                            position: absolute;
                            top: 5px;
                            right: 5px;
                            background: rgba(0,0,0,0.7);
                            color: white;
                            width: 20px;
                            height: 20px;
                            border-radius: 50%;
                            display: flex;
                            align-items: center;
                            justify-content: center;
                            font-size: 12px;
                        `;
                        number.textContent = index + 1;
                        
                        imgContainer.appendChild(img);
                        imgContainer.appendChild(number);
                        preview.appendChild(imgContainer);
                    };
                })(file, i);
                
                reader.onerror = function() {
                    showNotification(`–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–æ—Ç–æ ${i+1}`, 'error');
                };
                
                reader.readAsDataURL(file);
            }
            
            preview.style.display = 'block';
        }
        
        function selectPetType(type) {
            // –û–±–Ω–æ–≤–ª—è–µ–º –∫–Ω–æ–ø–∫–∏
            ['btnCat', 'btnDog', 'btnOther'].forEach(id => {
                const btn = document.getElementById(id);
                if (btn) {
                    btn.style.background = 'transparent';
                    btn.style.color = 'var(--primary)';
                    btn.style.border = '2px solid var(--primary)';
                }
            });
            
            const selectedBtn = document.getElementById('btn' + type.charAt(0).toUpperCase() + type.slice(1));
            if (selectedBtn) {
                selectedBtn.style.background = 'var(--primary)';
                selectedBtn.style.color = 'white';
                selectedBtn.style.border = '2px solid var(--primary)';
            }
            
            window.selectedPetType = type;
        }
        
        // ===== –ü–ê–†–¢–ù–Å–†–°–ö–ò–ô –†–ï–ñ–ò–ú =====
        function loadPartnerHome() {
            const totalPets = shelterPets.filter(pet => pet.ownerId === currentUser.id).length;
            document.getElementById('partnerTotalPets').textContent = totalPets;
            document.getElementById('partnerTotalLeads').textContent = '0';
        }
        
        function loadShelterPets() {
            const container = document.getElementById('shelterPetsList');
            if (!container) return;
            
            container.innerHTML = '';
            
            const userShelterPets = shelterPets.filter(pet => pet.ownerId === currentUser.id);
            
            if (userShelterPets.length === 0) {
                container.innerHTML = `
                    <div class="text-center" style="grid-column: 1 / -1; padding: 40px 20px;">
                        <i class="fas fa-paw" style="font-size: 48px; color: var(--primary-light); margin-bottom: 20px;"></i>
                        <h3 style="color: var(--dark); margin-bottom: 10px;">–ù–µ—Ç –ø–∏—Ç–æ–º—Ü–µ–≤ –≤ –ø—Ä–∏—é—Ç–µ</h3>
                        <p class="text-muted">–î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–≤–æ–≥–æ –ø–∏—Ç–æ–º—Ü–∞</p>
                    </div>
                `;
                return;
            }
            
            userShelterPets.forEach(pet => {
                const petCard = createPetCard(pet);
                container.appendChild(petCard);
            });
        }
        
        function loadPartnerLeads() {
            const container = document.getElementById('partnerLeadsList');
            if (!container) return;
            
            container.innerHTML = `
                <div class="list-item">
                    <i class="fas fa-user" style="color: var(--primary);"></i>
                    <div>
                        <div style="font-weight: 600;">–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤</div>
                        <div style="font-size: 12px; color: var(--gray);">–ò–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç—Å—è –∫–æ—Ç–æ–º –ë–∞—Ä—Å–∏–∫–æ–º</div>
                    </div>
                    <span class="badge badge-new">–ù–æ–≤–∞—è</span>
                </div>
            `;
        }
        
        function loadPartnerSettings() {
            const settingsPage = document.getElementById('partner-settings');
            if (!settingsPage) {
                // –°–æ–∑–¥–∞—ë–º —Å—Ç—Ä–∞–Ω–∏—Ü—É –Ω–∞—Å—Ç—Ä–æ–µ–∫ –ø–∞—Ä—Ç–Ω—ë—Ä–∞
                const html = `
                    <div class="card">
                        <div class="card-header">
                            <div class="card-title">
                                <i class="fas fa-cog"></i> –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–∞—Ä—Ç–Ω—ë—Ä–∞
                            </div>
                        </div>
                        
                        <div style="margin-bottom: 20px;">
                            <h4 style="color: var(--dark); margin-bottom: 10px;">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h4>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                                <div style="background: var(--light); padding: 15px; border-radius: 12px;">
                                    <div style="font-size: 12px; color: var(--gray);">–ü–∏—Ç–æ–º—Ü–µ–≤ –≤ –ø—Ä–∏—é—Ç–µ</div>
                                    <div style="font-size: 24px; font-weight: bold; color: var(--primary);">
                                        ${shelterPets.filter(p => p.ownerId === currentUser.id).length}
                                    </div>
                                </div>
                                <div style="background: var(--light); padding: 15px; border-radius: 12px;">
                                    <div style="font-size: 12px; color: var(--gray);">–ù–∞—à–ª–∏ –¥–æ–º</div>
                                    <div style="font-size: 24px; font-weight: bold; color: var(--primary);">
                                        ${shelterPets.filter(p => p.ownerId === currentUser.id && p.status === 'adopted').length}
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <button class="btn btn-outline mb-20" onclick="exportShelterData()">
                            <i class="fas fa-download"></i> –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏—é—Ç–∞
                        </button>
                        
                        <button class="btn btn-outline mb-20" onclick="clearShelterData()">
                            <i class="fas fa-trash"></i> –û—á–∏—Å—Ç–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏—é—Ç–∞
                        </button>
                    </div>
                `;
                
                const div = document.createElement('div');
                div.id = 'partner-settings';
                div.className = 'page';
                div.innerHTML = html;
                document.querySelector('.content').appendChild(div);
            }
            
            showPage('partner-settings');
        }
        
        // ===== –î–ï–¢–ê–õ–ò –ü–ò–¢–û–ú–¶–ê =====
        function showPetDetail(petId) {
            const pet = allPets.find(p => p.id === petId);
            if (!pet) return;
            
            const container = document.getElementById('petDetailContent');
            
            let photosHtml = '';
            if (pet.photos && pet.photos.length > 0) {
                photosHtml = `
                    <div style="margin-bottom: 20px;">
                        <div id="petPhotosCarousel" style="display: flex; overflow-x: auto; gap: 10px; padding: 10px 0;">
                            ${pet.photos.map((photo, index) => `
                                <img src="${photo}" style="height: 200px; border-radius: 12px; object-fit: cover;" 
                                     onclick="showFullImage('${photo}')">
                            `).join('')}
                        </div>
                    </div>
                `;
            }
            
            container.innerHTML = `
                ${photosHtml}
                
                <div style="margin-bottom: 20px;">
                    <h2 style="color: var(--dark); margin-bottom: 10px;">
                        ${pet.name || '–ë–µ–∑ –∏–º–µ–Ω–∏'}
                        <span class="status status-${pet.status}" style="margin-left: 10px;">
                            ${pet.status === 'available' ? '–ò—â–µ—Ç –¥–æ–º' : 
                              pet.status === 'reserved' ? '–ó–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω' : '–ü—Ä–∏—Å—Ç—Ä–æ–µ–Ω'}
                        </span>
                    </h2>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 15px;">
                        <div style="background: var(--light); padding: 15px; border-radius: 12px;">
                            <div style="font-size: 12px; color: var(--gray);">–¢–∏–ø</div>
                            <div style="font-weight: 600;">${pet.type === 'cat' ? '–ö–æ—à–∫–∞' : pet.type === 'dog' ? '–°–æ–±–∞–∫–∞' : '–î—Ä—É–≥–æ–µ'}</div>
                        </div>
                        <div style="background: var(--light); padding: 15px; border-radius: 12px;">
                            <div style="font-size: 12px; color: var(--gray);">–ü–æ–ª</div>
                            <div style="font-weight: 600;">${pet.sex === 'male' ? '–ú–∞–ª—å—á–∏–∫' : pet.sex === 'female' ? '–î–µ–≤–æ—á–∫–∞' : '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'}</div>
                        </div>
                        <div style="background: var(--light); padding: 15px; border-radius: 12px;">
                            <div style="font-size: 12px; color: var(--gray);">–í–æ–∑—Ä–∞—Å—Ç</div>
                            <div style="font-weight: 600;">${pet.age || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'}</div>
                        </div>
                        <div style="background: var(--light); padding: 15px; border-radius: 12px;">
                            <div style="font-size: 12px; color: var(--gray);">–ü–æ—Ä–æ–¥–∞</div>
                            <div style="font-weight: 600;">${pet.breed || '–ù–µ —É–∫–∞–∑–∞–Ω–∞'}</div>
                        </div>
                    </div>
                </div>
                
                ${pet.description ? `
                <div style="margin-bottom: 20px;">
                    <h3 style="color: var(--dark); margin-bottom: 10px;">–û–ø–∏—Å–∞–Ω–∏–µ</h3>
                    <div style="background: var(--light); padding: 15px; border-radius: 12px; line-height: 1.6;">
                        ${pet.description}
                    </div>
                </div>
                ` : ''}
                
                ${pet.specialNeeds ? `
                <div style="margin-bottom: 20px;">
                    <h3 style="color: var(--dark); margin-bottom: 10px;">–û—Å–æ–±—ã–µ –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç–∏</h3>
                    <div style="background: #FFF3E0; padding: 15px; border-radius: 12px;">
                        ${pet.specialNeeds}
                    </div>
                </div>
                ` : ''}
                
                <div style="margin-bottom: 20px;">
                    <h3 style="color: var(--dark); margin-bottom: 10px;">–ö–æ–Ω—Ç–∞–∫—Ç—ã</h3>
                    <div style="background: #E3F2FD; padding: 15px; border-radius: 12px;">
                        <div style="margin-bottom: 10px;">
                            <i class="fas fa-map-marker-alt"></i>
                            <strong> –ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:</strong> ${pet.location}
                        </div>
                        <div>
                            <i class="fas fa-phone"></i>
                            <strong> –ö–æ–Ω—Ç–∞–∫—Ç—ã:</strong> ${pet.contact}
                        </div>
                    </div>
                </div>
                
                ${pet.ownerType === 'shelter' ? `
                <div style="margin-bottom: 20px;">
                    <h3 style="color: var(--dark); margin-bottom: 10px;">–ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h3>
                    <div style="display: flex; gap: 15px;">
                        <div style="flex: 1; background: ${pet.vaccinated === 'yes' ? '#E8F5E9' : '#FFEBEE'}; padding: 15px; border-radius: 12px;">
                            <div style="font-size: 12px; color: var(--gray);">–í–∞–∫—Ü–∏–Ω–∞—Ü–∏—è</div>
                            <div style="font-weight: 600; color: ${pet.vaccinated === 'yes' ? '#2E7D32' : '#C62828'}">
                                ${pet.vaccinated === 'yes' ? '‚úÖ –ü—Ä–æ–≤–µ–¥–µ–Ω–∞' : pet.vaccinated === 'no' ? '‚ùå –ù–µ –ø—Ä–æ–≤–µ–¥–µ–Ω–∞' : '‚ùì –ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'}
                            </div>
                        </div>
                        <div style="flex: 1; background: ${pet.sterilized === 'yes' ? '#E8F5E9' : '#FFEBEE'}; padding: 15px; border-radius: 12px;">
                            <div style="font-size: 12px; color: var(--gray);">–°—Ç–µ—Ä–∏–ª–∏–∑–∞—Ü–∏—è</div>
                            <div style="font-weight: 600; color: ${pet.sterilized === 'yes' ? '#2E7D32' : '#C62828'}">
                                ${pet.sterilized === 'yes' ? '‚úÖ –ü—Ä–æ–≤–µ–¥–µ–Ω–∞' : pet.sterilized === 'no' ? '‚ùå –ù–µ –ø—Ä–æ–≤–µ–¥–µ–Ω–∞' : '‚ùì –ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'}
                            </div>
                        </div>
                    </div>
                </div>
                ` : ''}
                
                <div class="lead-actions">
                    <button class="btn btn-primary" onclick="contactAboutPet('${pet.id}')">
                        <i class="fas fa-comment"></i> –°–≤—è–∑–∞—Ç—å—Å—è
                    </button>
                    ${currentMode === 'user' && pet.ownerId === currentUser.id ? `
                    <button class="btn btn-outline" onclick="editPet('${pet.id}')">
                        <i class="fas fa-edit"></i> –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
                    </button>
                    <button class="btn btn-outline" onclick="deletePet('${pet.id}')" style="background: #FFEBEE; color: #C62828; border-color: #C62828;">
                        <i class="fas fa-trash"></i> –£–¥–∞–ª–∏—Ç—å
                    </button>
                    ` : ''}
                </div>
            `;
            
            showPage('pet-detail');
        }
        
        function contactAboutPet(petId) {
            const pet = allPets.find(p => p.id === petId);
            if (pet) {
                showNotification(`–ö–æ–Ω—Ç–∞–∫—Ç—ã –¥–ª—è —Å–≤—è–∑–∏: ${pet.contact}`, 'info');
            }
        }
        
        function editPet(petId) {
            const pet = allPets.find(p => p.id === petId);
            if (pet) {
                showNotification('–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∏—Ç–æ–º—Ü–∞', 'info');
                // –ó–¥–µ—Å—å –º–æ–∂–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ñ–æ—Ä–º—É —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
            }
        }
        
        function deletePet(petId) {
            if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ–≥–æ –ø–∏—Ç–æ–º—Ü–∞?')) {
                // –£–¥–∞–ª—è–µ–º –∏–∑ userPets
                userPets = userPets.filter(p => p.id !== petId);
                
                // –£–¥–∞–ª—è–µ–º –∏–∑ allPets
                allPets = allPets.filter(p => p.id !== petId);
                
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è
                saveUserData('user_pets', userPets);
                saveGlobalData('all_pets', allPets);
                
                showNotification('–ü–∏—Ç–æ–º–µ—Ü —É–¥–∞–ª—ë–Ω', 'success');
                showPage('user-pets');
            }
        }
        
        function showFullImage(imageSrc) {
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ–ª–Ω–æ—Ä–∞–∑–º–µ—Ä–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
            const modal = document.createElement('div');
            modal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background: rgba(0,0,0,0.9);
                display: flex;
                align-items: center;
                justify-content: center;
                z-index: 2000;
            `;
            
            modal.innerHTML = `
                <img src="${imageSrc}" style="max-width: 90%; max-height: 90%; border-radius: 8px;">
                <button onclick="this.parentElement.remove()" style="position: absolute; top: 20px; right: 20px; background: none; border: none; color: white; font-size: 24px; cursor: pointer;">
                    <i class="fas fa-times"></i>
                </button>
            `;
            
            document.body.appendChild(modal);
        }
        
        // ===== –£–¢–ò–õ–ò–¢–´ =====
        function showNotification(text, type = 'info') {
            const notification = document.getElementById('notification');
            const textElement = document.getElementById('notificationText');
            
            const icon = notification.querySelector('i');
            if (type === 'success') {
                icon.className = 'fas fa-check-circle';
                notification.style.background = 'var(--primary)';
            } else if (type === 'error') {
                icon.className = 'fas fa-exclamation-circle';
                notification.style.background = 'var(--danger)';
            } else {
                icon.className = 'fas fa-info-circle';
                notification.style.background = 'var(--secondary)';
            }
            
            textElement.textContent = text;
            notification.classList.remove('hidden');
            
            setTimeout(() => {
                notification.classList.add('hidden');
            }, 3000);
        }
        
        function exportUserData() {
            const data = {
                profile: currentUser,
                userPets: userPets,
                mode: currentMode,
                exportedAt: new Date().toISOString()
            };
            
            const json = JSON.stringify(data, null, 2);
            const blob = new Blob([json], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `futurepet_user_${currentUser.id}_${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            
            showNotification('–î–∞–Ω–Ω—ã–µ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã', 'success');
        }
        
        function exportShelterData() {
            const userShelterPets = shelterPets.filter(pet => pet.ownerId === currentUser.id);
            const data = {
                shelterId: currentUser.id,
                pets: userShelterPets,
                stats: {
                    total: userShelterPets.length,
                    available: userShelterPets.filter(p => p.status === 'available').length,
                    adopted: userShelterPets.filter(p => p.status === 'adopted').length
                },
                exportedAt: new Date().toISOString()
            };
            
            const json = JSON.stringify(data, null, 2);
            const blob = new Blob([json], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `futurepet_shelter_${currentUser.id}_${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            
            showNotification('–î–∞–Ω–Ω—ã–µ –ø—Ä–∏—é—Ç–∞ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã', 'success');
        }
        
        function clearShelterData() {
            if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã? –≠—Ç–æ —É–¥–∞–ª–∏—Ç –≤—Å–µ—Ö –ø–∏—Ç–æ–º—Ü–µ–≤ –≤–∞—à–µ–≥–æ –ø—Ä–∏—é—Ç–∞.')) {
                shelterPets = shelterPets.filter(pet => pet.ownerId !== currentUser.id);
                allPets = allPets.filter(pet => !(pet.ownerType === 'shelter' && pet.ownerId === currentUser.id));
                
                saveGlobalData('shelter_pets', shelterPets);
                saveGlobalData('all_pets', allPets);
                
                showNotification('–î–∞–Ω–Ω—ã–µ –ø—Ä–∏—é—Ç–∞ –æ—á–∏—â–µ–Ω—ã', 'success');
                showPage('partner-home');
            }
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        console.log('üêæ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ "–¢–≤–æ–π –ë—É–¥—É—â–∏–π –ü–∏—Ç–æ–º–µ—Ü" –∑–∞–≥—Ä—É–∂–µ–Ω–æ —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –¥–∞–Ω–Ω—ã—Ö!');
        console.log('ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:', getUserId());
    </script>
</body>
</html>
